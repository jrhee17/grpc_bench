FROM adoptopenjdk:16_36-jdk-hotspot

WORKDIR /app
COPY java_armeria_bench /app
COPY proto/helloworld/helloworld.proto /app/src/main/proto/helloworld.proto

RUN /app/gradlew installDist

ENV GC "-XX:+UseG1GC"
ENV JAVA_OPTS "${GC} -XX:MinRAMPercentage=70 -XX:MaxRAMPercentage=70"

ENTRYPOINT [ "/app/build/install/java_armeria_bench/bin/java_armeria_bench" ]
